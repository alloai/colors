!function(t,i,e,n){var r=t.fn.peity=function(i,e){return l&&this.each(function(){var n=t(this),h=n.data("_peity");h?(i&&(h.type=i),t.extend(h.opts,e)):(h=new a(n,i,t.extend({},r.defaults[i],n.data("peity"),e)),n.change(function(){h.draw()}).data("_peity",h)),h.draw()}),this},a=function(t,i,e){this.$el=t,this.type=i,this.opts=e},h=a.prototype,s=h.svgElement=function(e,n){return t(i.createElementNS("http://www.w3.org/2000/svg",e)).attr(n)},l="createElementNS"in i&&s("svg",{})[0].createSVGRect;h.draw=function(){var t=this.opts;r.graphers[this.type].call(this,t),t.after&&t.after.call(this,t)},h.fill=function(){var i=this.opts.fill;return t.isFunction(i)?i:function(t,e){return i[e%i.length]}},h.prepare=function(t,i){return this.$svg||this.$el.hide().after(this.$svg=s("svg",{class:"peity"})),this.$svg.empty().data("peity",this).attr({height:i,width:t})},h.values=function(){return t.map(this.$el.text().split(this.opts.delimiter),function(t){return parseFloat(t)})},r.defaults={},r.graphers={},r.register=function(t,i,e){this.defaults[t]=i,this.graphers[t]=e},r.register("pie",{fill:["#ff9900","#fff4dd","#ffc66e"],radius:8},function(i){if(!i.delimiter){var n=this.$el.text().match(/[^0-9\.]/);i.delimiter=n?n[0]:","}var r=t.map(this.values(),function(t){return t>0?t:0});if("/"==i.delimiter){var a=r[0],h=r[1];r=[a,e.max(0,h-a)]}for(var l=0,o=r.length,p=0;l<o;l++)p+=r[l];p||(o=2,p=1,r=[0,1]);var f=2*i.radius,c=this.prepare(i.width||f,i.height||f),d=c.width()/2,u=c.height()/2,g=e.min(d,u),v=i.innerRadius;"donut"!=this.type||v||(v=.5*g);var m=e.PI,y=this.fill(),w=this.scale=function(t,i){var n=t/p*m*2-m/2;return[i*e.cos(n)+d,i*e.sin(n)+u]},x=0;for(l=0;l<o;l++){var k,$=r[l],j=$/p;if(0!=j){if(1==j)if(v){var A=d-.01,E=u-g,F=u-v;k=s("path",{d:["M",d,E,"A",g,g,0,1,1,A,E,"L",A,F,"A",v,v,0,1,0,d,F].join(" ")})}else k=s("circle",{cx:d,cy:u,r:g});else{var M=x+$,S=["M"].concat(w(x,g),"A",g,g,0,j>.5?1:0,1,w(M,g),"L");v?S=S.concat(w(M,v),"A",v,v,0,j>.5?1:0,0,w(x,v)):S.push(d,u),x+=$,k=s("path",{d:S.join(" ")})}k.attr("fill",y.call(this,$,l,r)),c.append(k)}}}),r.register("donut",t.extend(!0,{},r.defaults.pie),function(t){r.graphers.pie.call(this,t)}),r.register("line",{delimiter:",",fill:"#c6d9fd",height:16,min:0,stroke:"#4d89f9",strokeWidth:1,width:32},function(t){var i=this.values();1==i.length&&i.push(i[0]);for(var n=e.max.apply(e,void 0==t.max?i:i.concat(t.max)),r=e.min.apply(e,void 0==t.min?i:i.concat(t.min)),a=this.prepare(t.width,t.height),h=t.strokeWidth,l=a.width(),o=a.height()-h,p=n-r,f=this.x=function(t){return t*(l/(i.length-1))},c=this.y=function(t){var i=o;return p&&(i-=(t-r)/p*o),i+h/2},d=c(e.max(r,0)),u=[0,d],g=0;g<i.length;g++)u.push(f(g),c(i[g]));u.push(l,d),t.fill&&a.append(s("polygon",{fill:t.fill,points:u.join(" ")})),h&&a.append(s("polyline",{fill:"none",points:u.slice(2,u.length-2).join(" "),stroke:t.stroke,"stroke-width":h,"stroke-linecap":"square"}))}),r.register("bar",{delimiter:",",fill:["#4D89F9"],height:16,min:0,padding:.1,width:32},function(t){for(var i=this.values(),n=e.max.apply(e,void 0==t.max?i:i.concat(t.max)),r=e.min.apply(e,void 0==t.min?i:i.concat(t.min)),a=this.prepare(t.width,t.height),h=a.width(),l=a.height(),o=n-r,p=t.padding,f=this.fill(),c=this.x=function(t){return t*h/i.length},d=this.y=function(t){return l-(o?(t-r)/o*l:1)},u=0;u<i.length;u++){var g,v=c(u+p),m=c(u+1-p)-v,y=i[u],w=d(y),x=w,k=w;o?y<0?x=d(e.min(n,0)):k=d(e.max(r,0)):g=1,0==(g=k-x)&&(g=1,n>0&&o&&x--),a.append(s("rect",{fill:f.call(this,y,u,i),x:v,y:x,width:m,height:g}))}})}(jQuery,document,Math);